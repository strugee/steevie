<VirtualHost 216.160.72.225:443>
  ServerName wiki.strugee.net

  DocumentRoot "/var/lib/mediawiki"


  <Directory "/var/lib/mediawiki">
    Options +FollowSymLinks
    AllowOverride all
    Require all granted
  </Directory>

  <Directory "/var/lib/mediawiki/config">
    Options -FollowSymLinks
    AllowOverride none
    Require all granted
    php_admin_flag engine off
    AddType text/plain .html .htm .shtml .phtml .php .php3 .php4 .php5 .php7
  </Directory>

  <Directory "/var/lib/mediawiki/images">
    Options -FollowSymLinks
    AllowOverride none
    Require all granted
    php_admin_flag engine off
    AddType text/plain .html .htm .shtml .phtml .php .php3 .php4 .php5 .php7
  </Directory>

  <Directory "/var/lib/mediawiki/upload">
    Options -FollowSymLinks
    AllowOverride none
    Require all granted
    php_admin_flag engine off
    AddType text/plain .html .htm .shtml .phtml .php .php3 .php4 .php5 .php7
  </Directory>

  ErrorLog "/var/log/apache2/wiki.strugee.net ssl_error_ssl.log"
  ServerSignature Off
  CustomLog "/var/log/apache2/wiki.strugee.net ssl_access_ssl.log" combined

  # Block access to SCM directories.
  <DirectoryMatch .*\.(svn|git|bzr|hg|ht)/.*>
    Require all denied
  </DirectoryMatch>

  Header Set Strict-Transport-Security: "max-age=31536000; includeSubDomains; preload"
  ## Rewrite rules
  RewriteEngine On

  RewriteRule ^/?wiki(/.*)?$ %{DOCUMENT_ROOT}/index.php [L]

  RewriteRule ^/*$ %{DOCUMENT_ROOT}/index.php [L]


</VirtualHost>
